(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[698],{1945:(e,l,a)=>{"use strict";a.d(l,{A:()=>n});var s=a(5155),r=a(2115),t=a(1990);let n=e=>{let{onUploadSuccess:l}=e,[a,n]=(0,r.useState)(null),[d,i]=(0,r.useState)(!1),[o,c]=(0,r.useState)(0),[u,x]=(0,r.useState)(null),m=(0,r.useRef)(null),h=async()=>{if(!a)return void x("Please select a file to upload");try{i(!0),c(0),await (0,t.KJ)(a,e=>{c(e)}),n(null),i(!1),c(100),m.current&&(m.current.value=""),l()}catch(e){console.error("Error uploading file:",e),x("Failed to upload file. Please try again."),i(!1)}};return(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 max-w-md mx-auto",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold mb-6 text-secondary",children:"Upload Book"}),(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)("label",{className:"block text-gray-700 mb-2",children:"Select Book File"}),(0,s.jsx)("input",{type:"file",accept:"application/pdf",onChange:e=>{var l;let a=null==(l=e.target.files)?void 0:l[0];a&&"application/pdf"===a.type?(n(a),x(null)):(n(null),x("Please select a valid PDF file"))},ref:m,className:"w-full p-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-primary",disabled:d})]}),a&&(0,s.jsx)("div",{className:"mb-4",children:(0,s.jsxs)("p",{className:"text-sm text-gray-600",children:["Selected file: ",a.name]})}),u&&(0,s.jsx)("div",{className:"mb-4",children:(0,s.jsx)("p",{className:"text-sm text-red-600",children:u})}),d&&(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2.5",children:(0,s.jsx)("div",{className:"bg-primary h-2.5 rounded-full",style:{width:"".concat(o,"%")}})}),(0,s.jsxs)("p",{className:"text-sm text-gray-600 mt-1",children:["Uploading: ",o,"%"]})]}),(0,s.jsx)("button",{onClick:h,disabled:!a||d,className:"w-full bg-primary text-white py-2 px-4 rounded hover:bg-primary-dark transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed",children:d?"Uploading...":"Upload Book"})]})}},2563:(e,l,a)=>{"use strict";a.r(l),a.d(l,{default:()=>u});var s=a(5155),r=a(2115),t=a(63),n=a(4901),d=a(9512),i=a(1945),o=a(2619),c=a.n(o);function u(){let{user:e,loading:l}=(0,n.As)(),a=(0,n.z8)(),o=(0,t.useRouter)(),[u,x]=(0,r.useState)("write"),[m,h]=(0,r.useState)(!1),[p,b]=(0,r.useState)(!1);return((0,r.useEffect)(()=>{l||e&&a||o.push("/")},[e,a,l,o]),!l&&e&&a)?(0,s.jsxs)("div",{className:"min-h-screen flex flex-col",children:[(0,s.jsxs)("header",{className:"bg-[#1F1F1F] border-b border-gray-800 py-4 px-6 flex justify-between items-center",children:[(0,s.jsx)("div",{className:"flex items-center",children:(0,s.jsx)("h1",{className:"text-2xl font-bold text-primary",children:"TuneTalez"})}),(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsx)("span",{className:"text-white",children:(null==e?void 0:e.displayName)||(null==e?void 0:e.email)}),(0,s.jsx)("button",{onClick:()=>{window.confirm("Are you sure you want to log out?")&&o.push("/")},className:"bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-md transition-colors duration-300",children:"Logout"})]})]}),(0,s.jsxs)("div",{className:"flex flex-1",children:[(0,s.jsx)("aside",{className:"w-64 bg-[#1F1F1F] text-white p-6 space-y-6 border-r border-gray-800 hidden md:block",children:(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-primary mb-3",children:"Admin Menu"}),(0,s.jsx)(c(),{href:"/admin",className:"block py-2 px-4 rounded hover:bg-[#2a2a2a] transition-colors duration-200 bg-[#2a2a2a] text-primary",children:"Dashboard"}),(0,s.jsx)("button",{onClick:()=>x("write"),className:"block w-full text-left py-2 px-4 rounded hover:bg-[#2a2a2a] transition-colors duration-200 ".concat("write"===u?"bg-[#2a2a2a] text-primary":"text-gray-300"),children:"Write Book"}),(0,s.jsx)("button",{onClick:()=>x("upload"),className:"block w-full text-left py-2 px-4 rounded hover:bg-[#2a2a2a] transition-colors duration-200 ".concat("upload"===u?"bg-[#2a2a2a] text-primary":"text-gray-300"),children:"Upload Book"})]})}),(0,s.jsx)("main",{className:"flex-1 bg-background p-6",children:(0,s.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold text-white mb-8",children:"Admin Dashboard"}),m&&(0,s.jsx)("div",{className:"bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded relative mb-6",role:"alert",children:(0,s.jsx)("span",{className:"block sm:inline",children:"Book published successfully!"})}),p&&(0,s.jsx)("div",{className:"bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded relative mb-6",role:"alert",children:(0,s.jsx)("span",{className:"block sm:inline",children:"Book uploaded successfully!"})}),(0,s.jsx)("div",{className:"flex justify-center mb-8 md:hidden",children:(0,s.jsxs)("div",{className:"bg-[#1F1F1F] rounded-lg p-1 inline-flex",children:[(0,s.jsx)("button",{onClick:()=>x("write"),className:"px-4 py-2 rounded-md ".concat("write"===u?"bg-primary text-white":"text-gray-300 hover:bg-[#2a2a2a]"),children:"Write Book"}),(0,s.jsx)("button",{onClick:()=>x("upload"),className:"px-4 py-2 rounded-md ".concat("upload"===u?"bg-primary text-white":"text-gray-300 hover:bg-[#2a2a2a]"),children:"Upload Book"})]})}),(0,s.jsx)("div",{className:"bg-[#1F1F1F] rounded-lg shadow-lg p-6",children:"write"===u?(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-2xl font-bold text-primary mb-6",children:"Write New Book"}),(0,s.jsx)(d.A,{onSuccess:()=>{h(!0),setTimeout(()=>{h(!1)},3e3)}})]}):(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-2xl font-bold text-primary mb-6",children:"Upload Book"}),(0,s.jsx)(i.A,{onUploadSuccess:()=>{b(!0),setTimeout(()=>{b(!1)},3e3)}})]})})]})})]})]}):(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,s.jsxs)("div",{className:"p-8 bg-[#1F1F1F] rounded-lg shadow-lg max-w-md w-full text-center",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary mx-auto"}),(0,s.jsx)("p",{className:"mt-4 text-white",children:"Loading admin dashboard..."})]})})}},4901:(e,l,a)=>{"use strict";a.d(l,{As:()=>i,OJ:()=>c,z8:()=>o});var s=a(5155),r=a(2115),t=a(6768),n=a(1990);let d=(0,r.createContext)({user:null,profile:null,loading:!0,logout:async()=>{},updateRole:async()=>{}}),i=()=>(0,r.useContext)(d),o=()=>{let{profile:e,loading:l}=i();return!l&&(null==e?void 0:e.role)==="admin"},c=e=>{let{children:l}=e,[a,i]=(0,r.useState)(null),[o,c]=(0,r.useState)(null),[u,x]=(0,r.useState)(!0);(0,r.useEffect)(()=>{(async()=>{if(a)try{let e=await (0,n.VM)(a.uid);e||(e=await (0,n.Vz)(a)),c(e)}catch(e){console.error("Error fetching user profile:",e)}else c(null)})()},[a]),(0,r.useEffect)(()=>{let e=(0,t.Bh)(e=>{i(e),e||x(!1)});return()=>e()},[]),(0,r.useEffect)(()=>{a&&o&&x(!1)},[a,o]);let m=async()=>{await (0,t.CI)()},h=async e=>{a&&(await (0,n.v_)(a.uid,e),c(l=>l?{...l,role:e}:null))};return(0,s.jsx)(d.Provider,{value:{user:a,profile:o,loading:u,logout:m,updateRole:h},children:l})}},5929:(e,l,a)=>{Promise.resolve().then(a.bind(a,2563))},6768:(e,l,a)=>{"use strict";a.d(l,{Bh:()=>o,CI:()=>i,G6:()=>d,Hh:()=>t,Jv:()=>n});var s=a(1328),r=a(5300);let t=async(e,l)=>(0,s.eJ)(r.j2,e,l),n=async(e,l)=>(0,s.x9)(r.j2,e,l),d=async()=>{let e=new s.HF;return(0,s.df)(r.j2,e)},i=async()=>(0,s.CI)(r.j2),o=e=>(0,s.hg)(r.j2,e)}},e=>{e.O(0,[135,210,4,277,372,619,404,512,441,493,358],()=>e(e.s=5929)),_N_E=e.O()}]);