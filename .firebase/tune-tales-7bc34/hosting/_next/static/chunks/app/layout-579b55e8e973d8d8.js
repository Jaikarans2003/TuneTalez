(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[177],{1990:(e,r,s)=>{"use strict";s.d(r,{HA:()=>w,KC:()=>n,KJ:()=>l,QC:()=>p,VM:()=>d,Vz:()=>c,be:()=>x,cP:()=>i,iC:()=>m,v_:()=>h,zy:()=>u});var t=s(5300),a=s(9708),o=s(9996);let l=async(e,r)=>{try{let s=(0,o.KR)(t.IG,"pdfs/".concat(e.name)),l=(0,o.bp)(s,e);return new Promise((s,n)=>{l.on("state_changed",e=>{let s=e.bytesTransferred/e.totalBytes*100;console.log("Upload is "+s+"% done"),r&&r(s)},e=>{console.error("Upload failed:",e),n(e)},async()=>{let r=await (0,o.qk)(l.snapshot.ref),n={name:e.name,url:r,createdAt:Date.now()},i=await (0,a.gS)((0,a.rJ)(t.db,"pdfs"),n);s({...n,id:i.id})})})}catch(e){throw console.error("Error uploading PDF:",e),e}},n=async()=>{try{let e=(0,a.P)((0,a.rJ)(t.db,"pdfs"),(0,a.My)("createdAt","desc"));return(await (0,a.GG)(e)).docs.map(e=>({id:e.id,...e.data()}))}catch(e){throw console.error("Error getting PDFs:",e),e}},i=async e=>{try{if(!e.id)throw Error("Document ID is required");await (0,a.kd)((0,a.H9)(t.db,"pdfs",e.id));let r=(0,o.KR)(t.IG,"pdfs/".concat(e.name));await (0,o.XR)(r)}catch(e){throw console.error("Error deleting PDF:",e),e}},c=async function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"reader";try{let s={uid:e.uid,email:e.email||"",displayName:e.displayName||"",photoURL:e.photoURL||"",role:r,createdAt:Date.now()};return await (0,a.BN)((0,a.H9)(t.db,"users",e.uid),s,{merge:!0}),s}catch(e){throw console.error("Error creating user profile:",e),e}},d=async e=>{try{let r=await (0,a.x7)((0,a.H9)(t.db,"users",e));if(r.exists())return r.data();return null}catch(e){throw console.error("Error getting user profile:",e),e}},h=async(e,r)=>{try{await (0,a.BN)((0,a.H9)(t.db,"users",e),{role:r},{merge:!0})}catch(e){throw console.error("Error updating user role:",e),e}},x=async(e,r)=>{try{let s="".concat(Date.now(),"_").concat(e.name),a=(0,o.KR)(t.IG,"books/thumbnails/".concat(s)),l=(0,o.bp)(a,e);return new Promise((e,s)=>{l.on("state_changed",e=>{let s=e.bytesTransferred/e.totalBytes*100;console.log("Upload is "+s+"% done"),r&&r(s)},e=>{console.error("Upload failed:",e),s(e)},async()=>{let r=await (0,o.qk)(l.snapshot.ref);e(r)})})}catch(e){throw console.error("Error uploading thumbnail:",e),e}},m=async e=>{try{let r={...e,createdAt:Date.now()},s=await (0,a.gS)((0,a.rJ)(t.db,"books"),r);return{...r,id:s.id}}catch(e){throw console.error("Error creating book:",e),e}},u=async()=>{try{let e=(0,a.P)((0,a.rJ)(t.db,"books"),(0,a.My)("createdAt","desc"));return(await (0,a.GG)(e)).docs.map(e=>({id:e.id,...e.data()}))}catch(e){throw console.error("Error getting books:",e),e}},p=async e=>{try{let r=(0,a.H9)(t.db,"books",e),s=await (0,a.x7)(r);if(s.exists())return{id:s.id,...s.data()};return null}catch(e){throw console.error("Error getting book:",e),e}},w=async e=>{try{if(!e.id)throw Error("Document ID is required");if(await (0,a.kd)((0,a.H9)(t.db,"books",e.id)),e.thumbnailUrl)try{let r=e.thumbnailUrl.split("books/thumbnails/").pop();if(r){let e=(0,o.KR)(t.IG,"books/thumbnails/".concat(r));await (0,o.XR)(e)}}catch(e){console.error("Error deleting thumbnail:",e)}}catch(e){throw console.error("Error deleting book:",e),e}}},3673:()=>{},4097:e=>{e.exports={style:{fontFamily:"'Inter', 'Inter Fallback'",fontStyle:"normal"},className:"__className_e8ce0c"}},4901:(e,r,s)=>{"use strict";s.d(r,{As:()=>i,OJ:()=>d,z8:()=>c});var t=s(5155),a=s(2115),o=s(6768),l=s(1990);let n=(0,a.createContext)({user:null,profile:null,loading:!0,logout:async()=>{},updateRole:async()=>{}}),i=()=>(0,a.useContext)(n),c=()=>{let{profile:e,loading:r}=i();return!r&&(null==e?void 0:e.role)==="admin"},d=e=>{let{children:r}=e,[s,i]=(0,a.useState)(null),[c,d]=(0,a.useState)(null),[h,x]=(0,a.useState)(!0);(0,a.useEffect)(()=>{(async()=>{if(s)try{let e=await (0,l.VM)(s.uid);e||(e=await (0,l.Vz)(s)),d(e)}catch(e){console.error("Error fetching user profile:",e)}else d(null)})()},[s]),(0,a.useEffect)(()=>{let e=(0,o.Bh)(e=>{i(e),e||x(!1)});return()=>e()},[]),(0,a.useEffect)(()=>{s&&c&&x(!1)},[s,c]);let m=async()=>{await (0,o.CI)()},u=async e=>{s&&(await (0,l.v_)(s.uid,e),d(r=>r?{...r,role:e}:null))};return(0,t.jsx)(n.Provider,{value:{user:s,profile:c,loading:h,logout:m,updateRole:u},children:r})}},5300:(e,r,s)=>{"use strict";s.d(r,{IG:()=>c,db:()=>i,j2:()=>d});var t=s(2078),a=s(9708),o=s(9996),l=s(1328);let n=(0,t.Dk)().length?(0,t.Dk)()[0]:(0,t.Wp)({apiKey:"AIzaSyB7byiynZrjiqAo8NDIurtBg-MVBolYSjY",authDomain:"tune-tales-7bc34.firebaseapp.com",projectId:"tune-tales-7bc34",storageBucket:"tune-tales-7bc34.firebasestorage.app",messagingSenderId:"73380609988",appId:"1:73380609988:web:deb202818f8a602f73ee91",measurementId:"G-54939GDQH8"}),i=(0,a.aU)(n),c=(0,o.c7)(n),d=(0,l.xI)(n)},6083:(e,r,s)=>{Promise.resolve().then(s.bind(s,9055))},6768:(e,r,s)=>{"use strict";s.d(r,{Bh:()=>c,CI:()=>i,G6:()=>n,Hh:()=>o,Jv:()=>l});var t=s(1328),a=s(5300);let o=async(e,r)=>(0,t.eJ)(a.j2,e,r),l=async(e,r)=>(0,t.x9)(a.j2,e,r),n=async()=>{let e=new t.HF;return(0,t.df)(a.j2,e)},i=async()=>(0,t.CI)(a.j2),c=e=>(0,t.hg)(a.j2,e)},9055:(e,r,s)=>{"use strict";s.r(r),s.d(r,{default:()=>x});var t=s(5155),a=s(2115),o=s(4097),l=s.n(o);s(3673);var n=s(2619),i=s.n(n),c=s(4901);let d=e=>{var r,s;let{isOpen:o,setIsOpen:l}=e,{user:n,profile:d,logout:h,updateRole:x}=(0,c.As)(),[m,u]=(0,a.useState)(!1),p=(0,a.useRef)(null),w=async()=>{try{await h()}catch(e){console.error("Logout failed:",e)}};return(0,a.useEffect)(()=>{let e=e=>{p.current&&!p.current.contains(e.target)&&u(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[]),(0,t.jsx)("header",{className:"bg-[#212121] text-white sticky top-0 z-50 shadow-md",children:(0,t.jsxs)("div",{className:"container mx-auto px-4 py-2 flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)("button",{onClick:()=>l(!o),className:"mr-3 text-white md:hidden","aria-label":"Toggle menu",children:(0,t.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),(0,t.jsxs)(i(),{href:"/",className:"flex items-center",children:[(0,t.jsx)("span",{className:"text-2xl font-bold text-primary mr-1",children:"Tune"}),(0,t.jsx)("span",{className:"text-2xl font-bold text-white",children:"Talez"})]})]}),(0,t.jsx)("div",{className:"hidden md:flex flex-1 max-w-2xl mx-8",children:(0,t.jsxs)("div",{className:"relative w-full",children:[(0,t.jsx)("input",{type:"text",placeholder:"Search books and PDFs...",className:"w-full bg-[#121212] border border-[#303030] rounded-l-full py-2 px-4 text-white focus:outline-none focus:border-[#404040]"}),(0,t.jsx)("button",{className:"absolute right-0 top-0 h-full bg-[#303030] px-4 rounded-r-full flex items-center justify-center hover:bg-[#404040]",children:(0,t.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})})]})}),(0,t.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,t.jsxs)(i(),{href:"/write",className:"hidden sm:flex items-center text-white hover:text-primary transition-colors",children:[(0,t.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),(0,t.jsx)("span",{children:"Write"})]}),(0,t.jsxs)(i(),{href:"/upload",className:"hidden sm:flex items-center text-white hover:text-primary transition-colors",children:[(0,t.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0l-4 4m4-4v12"})}),(0,t.jsx)("span",{children:"Upload"})]}),n?(0,t.jsxs)("div",{className:"relative",ref:p,children:[(0,t.jsxs)("button",{onClick:()=>{u(!m)},className:"flex items-center space-x-2 text-white hover:text-primary transition-colors",children:[(0,t.jsx)("div",{className:"w-8 h-8 rounded-full bg-gray-600 flex items-center justify-center overflow-hidden",children:n.photoURL?(0,t.jsx)("img",{src:n.photoURL,alt:"Profile",className:"w-full h-full object-cover"}):(0,t.jsx)("span",{className:"text-sm font-medium",children:null==(r=n.email)?void 0:r.charAt(0).toUpperCase()})}),(0,t.jsxs)("div",{className:"hidden md:block",children:[(0,t.jsx)("span",{className:"block",children:n.displayName||(null==(s=n.email)?void 0:s.split("@")[0])}),d&&(0,t.jsx)("span",{className:"text-xs text-gray-400 capitalize",children:d.role})]})]}),m&&(0,t.jsxs)("div",{className:"absolute right-0 mt-2 w-48 bg-[#1F1F1F] rounded-md shadow-lg py-1 z-50",children:[(0,t.jsx)(i(),{href:"/profile",className:"block w-full text-left px-4 py-2 text-sm text-white hover:bg-[#303030] transition-colors",children:"View Profile"}),d&&(0,t.jsxs)("div",{className:"px-4 py-2 border-b border-t border-gray-700",children:[(0,t.jsx)("p",{className:"text-sm text-white",children:"Account Type"}),(0,t.jsxs)("div",{className:"flex mt-1 space-x-2",children:[(0,t.jsx)("button",{onClick:()=>x("reader"),className:"text-xs px-2 py-1 rounded ".concat("reader"===d.role?"bg-primary text-white":"bg-gray-700 text-gray-300"),children:"Reader"}),(0,t.jsx)("button",{onClick:()=>x("author"),className:"text-xs px-2 py-1 rounded ".concat("author"===d.role?"bg-primary text-white":"bg-gray-700 text-gray-300"),children:"Author"})]})]}),(0,t.jsx)("button",{onClick:w,className:"block w-full text-left px-4 py-2 text-sm text-white hover:bg-[#303030] transition-colors",children:"Sign Out"})]})]}):(0,t.jsxs)(i(),{href:"/auth/signin",className:"bg-primary hover:bg-primary-dark text-white py-1 px-4 rounded-full flex items-center",children:[(0,t.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),(0,t.jsx)("span",{children:"Sign In"})]})]})]})})},h=e=>{let{isOpen:r}=e;return(0,t.jsx)("aside",{className:"bg-[#212121] text-white w-64 fixed left-0 top-16 bottom-0 overflow-y-auto transition-transform duration-300 z-40 ".concat(r?"translate-x-0":"-translate-x-full md:translate-x-0"),children:(0,t.jsxs)("div",{className:"flex flex-col h-full",children:[(0,t.jsx)("nav",{className:"py-4 px-4",children:(0,t.jsxs)("ul",{className:"space-y-2",children:[(0,t.jsx)("li",{children:(0,t.jsxs)(i(),{href:"/",className:"flex items-center py-2 px-4 rounded-lg hover:bg-[#303030] transition-colors",children:[(0,t.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})}),(0,t.jsx)("span",{children:"Home"})]})}),(0,t.jsx)("li",{children:(0,t.jsxs)(i(),{href:"/liked",className:"flex items-center py-2 px-4 rounded-lg hover:bg-[#303030] transition-colors",children:[(0,t.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})}),(0,t.jsx)("span",{children:"Liked"})]})}),(0,t.jsx)("li",{children:(0,t.jsxs)(i(),{href:"/saved",className:"flex items-center py-2 px-4 rounded-lg hover:bg-[#303030] transition-colors",children:[(0,t.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 5a2 2 0 012-2h10a2 2 0 012 2v16l-7-3.5L5 21V5z"})}),(0,t.jsx)("span",{children:"Saved"})]})}),(0,t.jsx)("li",{children:(0,t.jsxs)(i(),{href:"/orders",className:"flex items-center py-2 px-4 rounded-lg hover:bg-[#303030] transition-colors",children:[(0,t.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"})}),(0,t.jsx)("span",{children:"Orders"})]})})]})}),(0,t.jsx)("div",{className:"border-t border-[#303030] my-2"}),(0,t.jsxs)("div",{className:"px-4 py-2",children:[(0,t.jsx)("h3",{className:"text-sm font-semibold text-gray-400 mb-2 uppercase",children:"Library"}),(0,t.jsxs)("ul",{className:"space-y-2",children:[(0,t.jsx)("li",{children:(0,t.jsxs)(i(),{href:"/write",className:"flex items-center py-2 px-4 rounded-lg hover:bg-[#303030] transition-colors",children:[(0,t.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),(0,t.jsx)("span",{children:"Write Book"})]})}),(0,t.jsx)("li",{children:(0,t.jsxs)(i(),{href:"/upload",className:"flex items-center py-2 px-4 rounded-lg hover:bg-[#303030] transition-colors",children:[(0,t.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0l-4 4m4-4v12"})}),(0,t.jsx)("span",{children:"Upload Books"})]})})]})]}),(0,t.jsx)("div",{className:"flex-grow"}),(0,t.jsx)("div",{className:"mt-auto border-t border-[#303030] py-4 px-6",children:(0,t.jsxs)("div",{className:"text-sm text-gray-400",children:[(0,t.jsx)("h3",{className:"font-bold text-primary mb-1",children:"TuneTalez"}),(0,t.jsx)("p",{className:"text-xs mb-2",children:"Write books and upload PDF files with ease"}),(0,t.jsxs)("p",{children:["\xa9 ",new Date().getFullYear()," TuneTalez"]}),(0,t.jsx)("p",{className:"text-xs",children:"All rights reserved."})]})})]})})};function x(e){let{children:r}=e,[s,o]=(0,a.useState)(!1);return(0,t.jsx)("html",{lang:"en",children:(0,t.jsx)("body",{className:"".concat(l().className," flex flex-col min-h-screen bg-background"),children:(0,t.jsxs)(c.OJ,{children:[(0,t.jsx)(d,{isOpen:s,setIsOpen:o}),(0,t.jsxs)("div",{className:"flex flex-1 pt-16",children:[" ",(0,t.jsx)(h,{isOpen:s}),(0,t.jsx)("main",{className:"flex-grow md:ml-64 px-4 py-6",children:(0,t.jsx)("div",{className:"max-w-7xl mx-auto",children:r})})]}),s&&(0,t.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-30 md:hidden",onClick:()=>o(!1)})]})})})}}},e=>{e.O(0,[898,135,210,372,619,441,493,358],()=>e(e.s=6083)),_N_E=e.O()}]);